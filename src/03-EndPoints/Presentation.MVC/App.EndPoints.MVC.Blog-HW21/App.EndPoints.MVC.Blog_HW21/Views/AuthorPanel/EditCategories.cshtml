@model App.EndPoints.MVC.Blog_HW21.Models.Category.CategoryViewModel
@{
    Layout = "~/Views/Shared/EditCategory.cshtml";
    // Layout = null;
}
@section Styles {
    <link rel="stylesheet" href="~/css/EditeCategory.css" />
}
<!-- Floating background elements -->
<div class="floating-element" style="width: 80px; height: 80px; top: 10%; left: 5%; animation-delay: 0s;"></div>
<div class="floating-element" style="width: 60px; height: 60px; top: 70%; right: 10%; animation-delay: 2s;"></div>
<div class="floating-element" style="width: 100px; height: 100px; bottom: 20%; left: 8%; animation-delay: 4s;"></div>

<!-- Form Container -->
<div class="form-container">
    <!-- Form Header -->
    <div class="form-header">
        <div class="form-icon">
            <i class="fas fa-edit"></i>
        </div>
        <h1 class="form-title">ویرایش دسته‌بندی</h1>
        <p class="form-subtitle">اطلاعات دسته‌بندی را ویرایش کنید</p>
    </div>

    <!-- Form Body -->
    <form asp-action="EditCategories" method="post">
        <div class="form-body">
            <!-- Stats Row -->
            <div class="stats-row">
                <div class="stat-box">
                    <span class="stat-number" id="postCount">۲۴</span>
                    <span class="stat-label">تعداد پست‌ها</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number" id="commentCount">۱۲۵</span>
                    <span class="stat-label">تعداد نظرات</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number" id="viewCount">۱,۲۴۵</span>
                    <span class="stat-label">تعداد بازدید</span>
                </div>
            </div>

            <!-- Category Name Field -->
            <div class="form-group">
                <label for="categoryName">
                    <i class="fas fa-heading"></i>
                    نام دسته‌بندی
                </label>
                <input asp-for="Title"
                       type="text"
                       id="categoryName"
                       class="form-control"
                       placeholder="نام دسته‌بندی را وارد کنید"
                       value="@Model.Title"
                       required>
                <div class="char-counter">
                    <span>حداکثر ۵۰ کاراکتر</span>
                    <span class="char-count" id="nameCounter">۱۲/۵۰</span>
                </div>
                <input type="hidden" value="@Model.CategoryId" asp-for="CategoryId" />
            </div>

            <!-- Category Description Field -->
            <div class="form-group">
                <label for="categoryDescription">
                    <i class="fas fa-align-left"></i>
                    توضیحات دسته‌بندی
                </label>
                <textarea asp-for="Description" id="categoryDescription"
                          class="form-control"
                          placeholder="توضیحات کامل دسته‌بندی را وارد کنید"
                          required>@Model.Description</textarea>
                <div class="char-counter">
                    <span>حداکثر ۵۰۰ کاراکتر</span>
                    <span class="char-count" id="descCounter">۱۸۵/۵۰۰</span>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                
                    <button type="button" class="btn btn-secondary" onclick="cancelEdit()">
                        <i class="fas fa-times"></i>
                        انصراف
                    </button>
              
               
                    <button type="submit" class="btn btn-primary" onclick="submitForm()" id="submitBtn">
                        <i class="fas fa-save"></i>
                        ثبت ویرایش
                    </button>
                
            </div>
        </form>
   </div>
</div>

<script>
    // Initialize character counters
    const nameInput = document.getElementById('categoryName');
    const descInput = document.getElementById('categoryDescription');
    const nameCounter = document.getElementById('nameCounter');
    const descCounter = document.getElementById('descCounter');

    // Update counters on input
    nameInput.addEventListener('input', function() {
        const count = this.value.length;
        nameCounter.textContent = `${count}/۵۰`;
        if (count > 50) {
            nameCounter.style.color = '#ff4757';
        } else if (count > 40) {
            nameCounter.style.color = '#ffa502';
        } else {
            nameCounter.style.color = '#2ed573';
        }
    });

    descInput.addEventListener('input', function() {
        const count = this.value.length;
        descCounter.textContent = `${count}/۵۰۰`;
        if (count > 500) {
            descCounter.style.color = '#ff4757';
        } else if (count > 400) {
            descCounter.style.color = '#ffa502';
        } else {
            descCounter.style.color = '#2ed573';
        }
    });

    // Initialize with current values
    nameInput.dispatchEvent(new Event('input'));
    descInput.dispatchEvent(new Event('input'));

    // Form submission
    function submitForm() {
        const categoryName = nameInput.value.trim();
        const categoryDesc = descInput.value.trim();

        // Validation
        if (!categoryName) {
            alert('لطفا نام دسته‌بندی را وارد کنید');
            nameInput.focus();
            return;
        }

        if (categoryName.length > 50) {
            alert('نام دسته‌بندی نمی‌تواند بیشتر از ۵۰ کاراکتر باشد');
            nameInput.focus();
            return;
        }

        if (!categoryDesc) {
            alert('لطفا توضیحات دسته‌بندی را وارد کنید');
            descInput.focus();
            return;
        }

        if (categoryDesc.length > 500) {
            alert('توضیحات نمی‌تواند بیشتر از ۵۰۰ کاراکتر باشد');
            descInput.focus();
            return;
        }
         document.querySelector("form").submit();
        // Show loading state
        const submitBtn = document.getElementById('submitBtn');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> در حال ذخیره...';
        submitBtn.disabled = true;

        // Simulate API call
        setTimeout(() => {
            // Show success animation
            submitBtn.classList.add('success');
            submitBtn.innerHTML = '<i class="fas fa-check"></i> ویرایش با موفقیت ثبت شد';

            // Reset button after 2 seconds
            setTimeout(() => {
                submitBtn.classList.remove('success');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;

                // In real app, redirect or show success message
                alert(`دسته‌بندی "${categoryName}" با موفقیت ویرایش شد`);
            }, 2000);
        }, 1500);
    }

    // Cancel edit
    function cancelEdit() {
        if (confirm('آیا از انصراف از ویرایش اطمینان دارید؟ تغییرات ذخیره نشده از بین خواهند رفت.')) {
            // In real app, redirect back to dashboard
            alert('ویرایش لغو شد');
            // window.location.href = 'dashboard.html'; Change this to your actual dashboard URL
        }
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Ctrl + Enter to submit
        if (e.ctrlKey && e.key === 'Enter') {
            submitForm();
        }

        // Escape to cancel
        if (e.key === 'Escape') {
            cancelEdit();
        }
    });
</script>